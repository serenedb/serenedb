statement ok
CREATE TABLE basic_dml_test (key_column VARCHAR PRIMARY KEY, column2 INTEGER, flag_col INTEGER);

query
SELECT * FROM basic_dml_test;
----
key_column	column2	flag_col

statement count 1
INSERT INTO basic_dml_test VALUES ('a', 123, NULL);

query
SELECT * FROM basic_dml_test;
----
key_column	column2	flag_col
a	123	NULL

statement count 1
INSERT INTO basic_dml_test SELECT * FROM (VALUES ('b', 555, 1));

query
SELECT * FROM basic_dml_test ORDER BY key_column;
----
key_column	column2	flag_col
a	123	NULL
b	555	1

statement count 1
UPDATE basic_dml_test SET column2 = 3, flag_col = 0 WHERE key_column = 'a'

query
SELECT * FROM basic_dml_test ORDER BY key_column;
----
key_column	column2	flag_col
a	3	0
b	555	1

statement count 1
DELETE FROM basic_dml_test  WHERE key_column = 'a'

query
SELECT * FROM basic_dml_test;
----
key_column	column2	flag_col
b	555	1

statement count 1
DELETE FROM basic_dml_test

query
SELECT * FROM basic_dml_test;
----
key_column	column2	flag_col

# Test with data more than single batch (1024 rows)
statement ok
CREATE TABLE series_table(a INTEGER, b INTEGER,  c INTEGER, PRIMARY KEY(a,b,c));

statement count 8000
INSERT INTO series_table SELECT CAST(t1.x AS INTEGER), CAST(t2.x AS INTEGER), CAST(t3.x AS INTEGER) FROM
  generate_series(1, 20) as t1(x),
  generate_series(1, 20) as t2(x),
  generate_series(1, 20) as t3(x);

query
SELECT a, b, c FROM series_table ORDER BY a DESC,b DESC,c DESC LIMIT 1;
----
a	b	c
20	20	20

query
SELECT COUNT(*) from series_table;
----
count
8000

query
SELECT COUNT(a) from series_table;
----
count
8000

query
SELECT COUNT( DISTINCT a) from series_table;
----
count
20

statement count 8000
DELETE FROM series_table;

statement ok
CREATE TABLE cast_table(a INTEGER, b TIMESTAMP,  c SMALLINT, PRIMARY KEY(a,b));

statement count 1
INSERT INTO cast_table VALUES (CAST(1 AS BIGINT), '2025-01-01', CAST(9 AS INTEGER));

statement count 1
INSERT INTO cast_table VALUES ('11', '2025-02-01 12:59:59',  '9');

query
SELECT * FROM cast_table ORDER BY a;
----
a	b	c
1	2025-01-01 00:00:00	9
11	2025-02-01 12:59:59	9

statement count 1
UPDATE cast_table SET c = '123' WHERE a = 11;

query
SELECT * FROM cast_table ORDER BY a;
----
a	b	c
1	2025-01-01 00:00:00	9
11	2025-02-01 12:59:59	123

query error
INSERT INTO cast_table VALUES ('qqq', '2025-02-01 12:59:59',  '9');

statement count 2
DELETE FROM cast_table;
