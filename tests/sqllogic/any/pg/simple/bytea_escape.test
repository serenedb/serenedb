statement ok
SET BYTEA_OUTPUT = 'EsCaPe';

# Basic bytea literal - text conversion
skipif postgres-extended
query
SELECT 'hello'::bytea;
----
bytea
hello

# Empty bytea
skipif postgres-extended
query
SELECT ''::bytea;
----
bytea
(empty)

# Basic bytea literal - hex format
skipif postgres-extended
query
SELECT '\x48656c6c6f'::bytea;
----
bytea
Hello

# Bytea with hex notation - uppercase
skipif postgres-extended
query
SELECT '\x48454C4C4F'::bytea;
----
bytea
HELLO


# Bytea with hex notation - mixed case
skipif postgres-extended
query
SELECT '\x48654C6c4F'::bytea;
----
bytea
HeLlO


# Bytea with null byte
skipif postgres-extended
query
SELECT '\x00'::bytea;
----
bytea
\\000


# Bytea with multiple null bytes
skipif postgres-extended
query
SELECT '\x000000'::bytea;
----
bytea
\\000\\000\\000


# Bytea with null bytes in middle
skipif postgres-extended
query
SELECT '\x48656c00006c6f'::bytea;
----
bytea
Hel\\000\\000lo


# Bytea with all byte values (0-255 sample)
skipif postgres-extended
query
SELECT '\x00010203040506070809'::bytea;
----
bytea
\\000\\001\\002\\003\\004\\005\\006\\007\\010\\011


# Bytea with high byte values
skipif postgres-extended
query
SELECT '\xFEFF'::bytea;
----
bytea
\\376\\377


# Bytea with escape format
skipif postgres-extended
query
SELECT E'\\x414243'::bytea;
----
bytea
ABC


# Bytea from text with special characters
skipif postgres-extended
query
SELECT 'hello@world#2024'::bytea;
----
bytea
hello@world#2024


# Bytea from text with newline
skipif postgres-extended
query
SELECT E'line1\nline2'::bytea;
----
bytea
line1\\012line2


# Bytea from text with tab
skipif postgres-extended
query
SELECT E'tab\there'::bytea;
----
bytea
tab\\011here


# Bytea from text with quotes
skipif postgres-extended
query
SELECT 'it''s working'::bytea;
----
bytea
it's working


# Bytea with unicode - Chinese
skipif postgres-extended
query
SELECT '‰Ω†Â•Ω‰∏ñÁïå'::bytea;
----
bytea
\\344\\275\\240\\345\\245\\275\\344\\270\\226\\347\\225\\214


# Bytea with unicode - emoji
skipif postgres-extended
query
SELECT 'üåçüåéüåè'::bytea;
----
bytea
\\360\\237\\214\\215\\360\\237\\214\\216\\360\\237\\214\\217


# Bytea with unicode - accented
skipif postgres-extended
query
SELECT 'caf√© r√©sum√© na√Øve'::bytea;
----
bytea
caf\\303\\251 r\\303\\251sum\\303\\251 na\\303\\257ve


# Bytea with spaces
skipif postgres-extended
query
SELECT '  spaces  '::bytea;
----
bytea
  spaces  


# Bytea representing binary data - DEADBEEF
skipif postgres-extended
query
SELECT '\xDEADBEEF'::bytea;
----
bytea
\\336\\255\\276\\357


# Bytea representing binary data - all Fs
skipif postgres-extended
query
SELECT '\xFFFFFFFF'::bytea;
----
bytea
\\377\\377\\377\\377


# Bytea with single byte
skipif postgres-extended
query
SELECT '\x41'::bytea;
----
bytea
A


# Bytea with two bytes
skipif postgres-extended
query
SELECT '\x4142'::bytea;
----
bytea
AB


# Bytea odd number of hex digits should fail but test even
skipif postgres-extended
query
SELECT '\x010203'::bytea;
----
bytea
\\001\\002\\003


skipif postgres-extended
query
SELECT '\x01 02 03'::bytea;
----
bytea
\\001\\002\\003

skipif postgres-extended
query
SELECT '\121\121'::bytea;
----
bytea
QQ

# Bytea array - single element
skipif postgres-extended
query
SELECT ARRAY['\x48656c6c6f'::bytea];
----
array
{Hello}


# Bytea array - multiple elements
skipif postgres-extended
query
SELECT ARRAY['\x41'::bytea, '\x42'::bytea, '\x43'::bytea];
----
array
{A,B,C}


# Bytea array - with null bytes
skipif postgres-extended
query
SELECT ARRAY['\x00'::bytea, '\xFF'::bytea];
----
array
{"\\\\000","\\\\377"}


# Bytea array - with text conversion
skipif postgres-extended
query
SELECT ARRAY['hello'::bytea, 'world'::bytea];
----
array
{hello,world}


# Bytea array - empty bytea elements
skipif postgres-extended
query
SELECT ARRAY[''::bytea, ''::bytea, ''::bytea];
----
array
{"","",""}


# Bytea array - unicode strings as bytea
skipif postgres-extended
query
SELECT ARRAY['‰∏ñÁïå'::bytea, 'üåç'::bytea, 'caf√©'::bytea];
----
array
{"\\\\344\\\\270\\\\226\\\\347\\\\225\\\\214","\\\\360\\\\237\\\\214\\\\215","caf\\\\303\\\\251"}


# NULL bytea
skipif postgres-extended
query
SELECT NULL::bytea;
----
bytea
NULL


# Bytea array with NULL
skipif postgres-extended
query
SELECT ARRAY[NULL::bytea];
----
array
{NULL}


# Bytea array with NULL and values
skipif postgres-extended
query
SELECT ARRAY['\x41'::bytea, NULL::bytea, '\x42'::bytea];
----
array
{A,NULL,B}


# Bytea array with mixed formats
skipif postgres-extended
query
SELECT ARRAY['\xDEAD'::bytea, 'text'::bytea, '\xBEEF'::bytea];
----
array
{"\\\\336\\\\255",text,"\\\\276\\\\357"}


# Bytea with long hex string
skipif postgres-extended
query
SELECT '\x0102030405060708090A0B0C0D0E0F101112131415'::bytea;
----
bytea
\\001\\002\\003\\004\\005\\006\\007\\010\\011\\012\\013\\014\\015\\016\\017\\020\\021\\022\\023\\024\\025


# Bytea with PDF header signature
skipif postgres-extended
query
SELECT '\x255044462D'::bytea;
----
bytea
%PDF-


# Bytea with PNG header signature
skipif postgres-extended
query
SELECT '\x89504E470D0A1A0A'::bytea;
----
bytea
\\211PNG\\015\\012\\032\\012


# Bytea with JPEG header signature
skipif postgres-extended
query
SELECT '\xFFD8FFE0'::bytea;
----
bytea
\\377\\330\\377\\340


# Bytea with ZIP header signature
skipif postgres-extended
query
SELECT '\x504B0304'::bytea;
----
bytea
PK\\003\\004


# Disabled because of precommit checks
# Bytea from text with only spaces
# query
# SELECT '   '::bytea;
# ----
# bytea


# Bytea with carriage return and newline
skipif postgres-extended
query
SELECT E'text\r\nmore'::bytea;
----
bytea
text\\015\\012more


# Bytea with form feed
skipif postgres-extended
query
SELECT E'page1\fpage2'::bytea;
----
bytea
page1\\014page2


# Bytea with vertical tab
skipif postgres-extended
query
SELECT E'text1\ttext2'::bytea;
----
bytea
text1\\011text2


# Bytea with bell character
skipif postgres-extended
query
SELECT E'alert\a'::bytea;
----
bytea
alerta


# Bytea array with special binary sequences
skipif postgres-extended
query
SELECT ARRAY['\x00'::bytea, '\xFF'::bytea, '\xDEAD'::bytea, '\xBEEF'::bytea];
----
array
{"\\\\000","\\\\377","\\\\336\\\\255","\\\\276\\\\357"}


# Bytea with alternating bits
skipif postgres-extended
query
SELECT '\xAAAAAAAA'::bytea;
----
bytea
\\252\\252\\252\\252


# Bytea with alternating bits pattern 2
skipif postgres-extended
query
SELECT '\x55555555'::bytea;
----
bytea
UUUU


# Bytea representing 64-bit integer max
skipif postgres-extended
query
SELECT '\xFFFFFFFFFFFFFFFF'::bytea;
----
bytea
\\377\\377\\377\\377\\377\\377\\377\\377


# Bytea with escape sequences in text
skipif postgres-extended
query
SELECT E'\x41\x42\x43'::bytea;
----
bytea
ABC

skipif postgres-extended
query
SELECT ARRAY['\x01 02 03'::bytea, '\x01 02 03'::bytea];
----
array
{"\\\\001\\\\002\\\\003","\\\\001\\\\002\\\\003"}

skipif postgres-extended
query
SELECT ARRAY['\121\121'::bytea, '\121\121'::bytea];
----
array
{QQ,QQ}


query
SELECT '\x48656c6c6f'::bytea = '\x48656c6c6f'::varchar::bytea;
----
?column?
t
