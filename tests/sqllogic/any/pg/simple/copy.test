statement ok
CREATE TABLE tindex
(
  id INTEGER PRIMARY KEY,
  name TEXT
);


statement ok
CREATE TABLE clickclack
(
  id INTEGER PRIMARY KEY,
  name TEXT
);


statement count 3
INSERT INTO tindex VALUES (1, 'vedernikoff'), (2, 'pavelvi'), (3, 'babsky');


statement count 3
COPY tindex TO '/tmp/quit_low_salary.csv';


statement count 3
COPY clickclack FROM '/tmp/quit_low_salary.csv';


query
SELECT * FROM clickclack;
----
id name
1 vedernikoff
2 pavelvi
3 babsky


statement count 3
DELETE FROM clickclack;


statement count 2
COPY clickclack FROM '/tmp/quit_low_salary.csv' WHERE id != 2;


query
SELECT * FROM clickclack;
----
id name
1 vedernikoff
3 babsky


statement count 2
DELETE FROM clickclack;


# statement count 1
# COPY (SELECT * FROM tindex ORDER BY 1 DESC LIMIT 1) TO '/tmp/quit_low_salary.csv';
# 
# 
# statement count 1
# COPY clickclack FROM '/tmp/quit_low_salary.csv';
# 
# 
# query
# SELECT * FROM clickclack;
# ----
# id name
# 3 babsky
# 
# 
# statement count 1
# DELETE FROM clickclack;


statement ok
CREATE TABLE reversed
(
  name TEXT PRIMARY KEY,
  id INTEGER
);


statement count 3
COPY tindex TO '/tmp/lmao';


statement count 3
COPY reversed(id, name) FROM '/tmp/lmao';


query
SELECT * FROM reversed;
----
name id
babsky 3
pavelvi 2
vedernikoff 1


statement count 3
DELETE FROM reversed;


statement count 3
COPY tindex(name, id) TO '/tmp/lmao';


statement count 3
COPY reversed FROM '/tmp/lmao';


query
SELECT * FROM reversed;
----
name id
babsky 3
pavelvi 2
vedernikoff 1


# copy to + match
# wrong option
