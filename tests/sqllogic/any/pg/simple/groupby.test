query ????? rowsort
SELECT
  university.student,
  COUNT(mark) FILTER (WHERE university.mark = 2),
  COUNT(DISTINCT mark),
  ARRAY_AGG(mark ORDER BY mark DESC),
  ARRAY_AGG(mark ORDER BY mark ASC)
FROM
(
  VALUES
    (1, 'vedernikoff'), (2, 'vedernikoff'), (2, 'vedernikoff'),
    (3, 'vedernikoff'), (3, 'vedernikoff'), (3, 'vedernikoff'),
    (10, 'nemov'), (10, 'malko'), (10, 'malko')
) AS university(mark, student)
GROUP BY university.student
ORDER BY student;
----
student	count	count	array_agg	array_agg
malko	0	1	{10,10}	{10,10}
nemov	0	1	{10}	{10}
vedernikoff	2	3	{3,3,3,2,2,1}	{1,2,2,3,3,3}


query ???????? rowsort
SELECT
  grade, clickclack.grade,
  COUNT(clickclack.grade), COUNT(grade), SUM(weight),
  AVG(weight)::float8, MIN(3 * grade + weight + 2), MAX(weight + grade)
FROM
(
  VALUES
    (13, 'ssvor', 54), (13, 'ssvor', 55), (13, 'krivda', 43),
    (15, 'vedernikoff', 77), (15, 'tuetue', 83), (16, 'gayazov', 90),
    (17, 'vitalig', 135), (18, 'babsky', 134), (18, 'zhidsky', 145)
) AS clickclack(grade, name, weight)
GROUP BY grade;
----
grade	grade	count	count	sum	avg	min	max
13	13	3	3	152	50.666666666666664	84	68
15	15	2	2	160	80	124	98
16	16	1	1	90	90	140	106
17	17	1	1	135	135	188	152
18	18	2	2	279	139.5	190	163


query ??? rowsort
SELECT
  grade, name, SUM(weight) / COUNT(weight)
FROM
(
  VALUES
    (13, 'ssvor', 54), (13, 'ssvor', 55), (13, 'krivda', 43),
    (15, 'vedernikoff', 77), (15, 'tuetue', 83), (16, 'gayazov', 90),
    (17, 'vitalig', 135), (18, 'babsky', 134), (18, 'zhidsky', 145)
) AS clickclack(grade, name, weight)
GROUP BY grade, name
HAVING AVG(weight)::float8 > 69
ORDER BY MAX(weight) DESC;
----
grade	name	?column?
15	tuetue	83
15	vedernikoff	77
16	gayazov	90
17	vitalig	135
18	babsky	134
18	zhidsky	145


query ???? rowsort
SELECT
  grade + weight, AVG(weight)::float8,
  MIN(name), MAX(name)
FROM
(
  VALUES
    (13, 'ssvor', 54), (13, 'krivda', 43), (15, 'vedernikoff', 77),
    (15, 'tuetue', 83), (16, 'gayazov', 90), (17, 'vitalig', 135),
    (18, 'babsky', 134), (18, 'zhidsky', 145)
) AS clickclack(grade, name, weight)
GROUP BY grade + weight;
----
?column?	avg	min	max
106	90	gayazov	gayazov
152	134.5	babsky	vitalig
163	145	zhidsky	zhidsky
56	43	krivda	krivda
67	54	ssvor	ssvor
92	77	vedernikoff	vedernikoff
98	83	tuetue	tuetue


query ?? rowsort
SELECT
  grade + weight as magic_num, MIN(name)
FROM
(
  VALUES
    (13, 'ssvor', 54), (13, 'krivda', 43), (15, 'vedernikoff', 77),
    (15, 'tuetue', 83), (16, 'gayazov', 90), (17, 'vitalig', 135),
    (18, 'babsky', 134), (18, 'zhidsky', 145)
) AS clickclack(grade, name, weight)
GROUP BY magic_num
ORDER BY magic_num DESC;
----
magic_num	min
106	gayazov
152	babsky
163	zhidsky
56	krivda
67	ssvor
92	vedernikoff
98	tuetue


query ?? rowsort
SELECT
  grade + weight as magic_num, MIN(name)
FROM
(
  VALUES
    (13, 'ssvor', 54), (13, 'krivda', 43), (15, 'vedernikoff', 77),
    (15, 'tuetue', 83), (16, 'gayazov', 90), (17, 'vitalig', 135),
    (18, 'babsky', 134), (18, 'zhidsky', 145)
) AS clickclack(grade, name, weight)
GROUP BY magic_num
ORDER BY grade + weight DESC;
----
magic_num	min
106	gayazov
152	babsky
163	zhidsky
56	krivda
67	ssvor
92	vedernikoff
98	tuetue


query ??? rowsort
SELECT
  grade + weight as magic_num,
  grade + weight as magic_num,
  MIN(name)
FROM
(
  VALUES
    (13, 'ssvor', 54), (13, 'krivda', 43), (15, 'vedernikoff', 77),
    (15, 'tuetue', 83), (16, 'gayazov', 90), (17, 'vitalig', 135),
    (18, 'babsky', 134), (18, 'zhidsky', 145)
) AS clickclack(grade, name, weight)
GROUP BY grade + weight
ORDER BY magic_num DESC;
----
magic_num	magic_num	min
106	106	gayazov
152	152	babsky
163	163	zhidsky
56	56	krivda
67	67	ssvor
92	92	vedernikoff
98	98	tuetue


query ??? rowsort
SELECT kostya_iq + vedernikoff_iq, AVG(babsky_power)::float8, deadinside_level + babsky_power
FROM
(
  VALUES
    (1, 2, 3, 4), (1, 2, 5, 6),
    (1, 2, 5, 6), (3, 4, 3, 4)
) AS clickclack_university(kostya_iq, vedernikoff_iq, deadinside_level, babsky_power)
GROUP BY kostya_iq + vedernikoff_iq, deadinside_level + babsky_power
ORDER BY deadinside_level + babsky_power DESC;
----
?column?	avg	?column?
3	4	7
3	6	11
7	4	7


query ??? rowsort
SELECT
  AVG(grade)::float8, MIN(name), MAX(weight)
FROM
(
  VALUES
    (13, 'ssvor', 54), (13, 'ssvor', 55), (13, 'krivda', 43),
    (15, 'vedernikoff', 77), (15, 'tuetue', 83), (16, 'gayazov', 90),
    (17, 'vitalig', 135), (18, 'babsky', 134), (18, 'zhidsky', 145)
) AS clickclack(grade, name, weight)
ORDER BY COUNT(grade);
----
avg	min	max
15.333333333333334	babsky	145


query ? rowsort
SELECT
  grade as superhot
FROM
(
  VALUES
    (13, 'ssvor', 54), (13, 'ssvor', 55), (13, 'krivda', 43)
) AS clickclack(superhot, name, grade)
GROUP BY superhot, grade
ORDER BY superhot;
----
superhot
43
54
55


query ?? rowsort
SELECT
  grade as superhot, name as superhot
FROM
(
  VALUES
    (13, 'ssvor', 54), (13, 'ssvor', 55), (13, 'krivda', 43)
) AS clickclack(superhot, name, grade)
GROUP BY grade, superhot, name;
----
superhot	superhot
43	krivda
54	ssvor
55	ssvor


query ?? rowsort
SELECT
  grade as peklo, grade as peklo
FROM
(
  VALUES
    (13, 'ssvor', 54), (13, 'ssvor', 55), (13, 'krivda', 43)
) AS clickclack(superhot, name, grade)
GROUP BY peklo
----
peklo	peklo
43	43
54	54
55	55


query ?? rowsort
SELECT
  COUNT(*), COUNT(nullik)
FROM
(
  VALUES
    (NULL), (NULL), (NULL)
) AS kostya(nullik);
----
count	count
3	0


query
SELECT grade
FROM
(
  VALUES
    ('babsky', 22 ), ('babsky', 20), ('babsky', 21), ('babsky', 21),
    ('vedernikoff', 14), ('vedernikoff', 13), ('vedernikoff', 14)
) as clickclack(name, grade)
GROUP BY 1, 1
ORDER BY 1, 1, 1, 1;
----
grade
13
14
20
21
22


query
SELECT grade
FROM
(
  VALUES
    ('babsky', 22 ), ('babsky', 20), ('babsky', 21), ('babsky', 21),
    ('vedernikoff', 14), ('vedernikoff', 13), ('vedernikoff', 14)
) as clickclack(name, grade)
GROUP BY grade, grade
ORDER BY 1;
----
grade
13
14
20
21
22


query
SELECT *, *
FROM
(
  VALUES
    ('babsky', 22 ), ('babsky', 20), ('babsky', 21), ('babsky', 21),
    ('vedernikoff', 14), ('vedernikoff', 13), ('vedernikoff', 14)
) as clickclack(name, grade)
GROUP BY 1, 2, 1, 2
ORDER BY 1, 2;
----
name	grade	name	grade
babsky	20	babsky	20
babsky	21	babsky	21
babsky	22	babsky	22
vedernikoff	13	vedernikoff	13
vedernikoff	14	vedernikoff	14


query
SELECT *, *
FROM
(
  VALUES
    ('babsky', 22 ), ('babsky', 20), ('babsky', 21), ('babsky', 21),
    ('vedernikoff', 14), ('vedernikoff', 13), ('vedernikoff', 14)
) as clickclack(name, grade)
GROUP BY name, grade, grade, name
ORDER BY 1, 2;
----
name	grade	name	grade
babsky	20	babsky	20
babsky	21	babsky	21
babsky	22	babsky	22
vedernikoff	13	vedernikoff	13
vedernikoff	14	vedernikoff	14


query
SELECT *, *
FROM
(
  VALUES
    ('babsky1', 22, -5), ('babsky2', 20, -3), ('babsky3', 21, -4), ('babsky', 21, -4),
    ('vedernikoff', 14, 6), ('vedernikoff', 13, 4), ('vedernikoff', 14, 87)
) as clickclack(name, grade, iq)
GROUP BY 1, 2, 3, 2, 1, 3, 2, 1, 3, 1, 2, 3, 2, 1, 2, 3, 1, 2, 3, 2, 1, 3
ORDER BY 1, 2, 3;
----
name	grade	iq	name	grade	iq
babsky	21	-4	babsky	21	-4
babsky1	22	-5	babsky1	22	-5
babsky2	20	-3	babsky2	20	-3
babsky3	21	-4	babsky3	21	-4
vedernikoff	13	4	vedernikoff	13	4
vedernikoff	14	6	vedernikoff	14	6
vedernikoff	14	87	vedernikoff	14	87
