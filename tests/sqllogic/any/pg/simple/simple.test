query
SELECT 1;
----
?column?
1


query
SELECT 1 + 2 * 3 % 7 - 1;
----
?column?
6

query
SELECT x FROM generate_series(5, 15) AS t1(x)
----
x
5
6
7
8
9
10
11
12
13
14
15


# join crashes
# query
# SELECT x, y FROM generate_series(5, 15) AS t1(x)
# LEFT JOIN generate_series(90, 100) AS t2(y)
# ON true
# WHERE x + y < 100;
# ----


query
SELECT ARRAY['clickclack', 'vedernikoff', 'arelav'] AS c1, 'kek' AS c2, ARRAY[1, 2, 3] AS c3;
----
c1	c2	c3
{clickclack,vedernikoff,arelav}	kek	{1,2,3}


query
SELECT ARRAY[ARRAY['1000-7', 'pudge', 'sydb'], ARRAY['kek', 'deadinside', 'lol']];
----
array
{{1000-7,pudge,sydb},{kek,deadinside,lol}}


query
SELECT ARRAY[ARRAY[ARRAY['a', 'b'], ARRAY['c', 'd']], ARRAY[ARRAY['kek', 'lol'], ARRAY['deadinside', 'pudge']]];
----
array
{{{a,b},{c,d}},{{kek,lol},{deadinside,pudge}}}


query
VALUES (1, 2, 3), (10, 20, 30);
----
column1	column2	column3
1	2	3
10	20	30


# Naming
# query
# SELECT * FROM
#   (VALUES (1, 2, 3), (10, 20, 30)) AS t1(x, y, z),
#   (VALUES ('x'), ('y')) AS t2(c1, c2);
# ----


query
SELECT FALSE AND TRUE OR FALSE AND NOT TRUE;
----
?column?
f


query
SELECT NULL;
----
?column?
NULL


query
SELECT 1 IS NULL;
----
?column?
f


query
SELECT 1 IS NOT NULL;
----
?column?
t


query
SELECT LEAST('skuf', 'arelav', 'levap'), GREATEST(2, 2, 8, 1, 3, 3, 8);
----
least	greatest
arelav	8


query
SELECT GREATEST(1.5, 2.7, 0.8, 3.2) as result;
----
result
3.2


# query
# SELECT UNNEST(ARRAY[1, 2, 3]);
# ----
# 1
# 2
# 3


query
SELECT
  CASE
    WHEN x = 1 THEN 'one'
    WHEN x = 2 THEN 'two'
    ELSE 'other'
  END
FROM UNNEST(ARRAY[1, 2, 3]) AS t(x);
----
case
one
two
other


query
SELECT
  CASE x
    WHEN 1 THEN 'one'
    WHEN 2 THEN 'two'
    ELSE 'other'
  END
FROM UNNEST(ARRAY[1, 2, 3]) AS t(x);
----
case
one
two
other


query
VALUES (1, 2, 3)
----
column1	column2	column3
1	2	3


query error
SELECT 1 AND 2;
----
db error: ERROR: argument of AND must be type boolean, not type integer


query
SELECT 228
WHERE true;
----
?column?
228


query
SELECT 1 WHERE '1' IN ('2', '3', '1');
----
?column?
1


query
SELECT 1 WHERE '1' NOT IN ('2', '3', '1');
----
?column?


query
SELECT 'kostya' LIKE 'kostya';
----
?column?
t


query
SELECT 'kostya' LIKE 'k%';
----
?column?
t


query
SELECT 'kostya' LIKE '%tya';
----
?column?
t


query
SELECT 'kostya' LIKE '%ost%';
----
?column?
t


query
SELECT 'kostya' LIKE 'k_stya';
----
?column?
t


query
SELECT 'kostya' LIKE 'vedernikoff';
----
?column?
f


query
SELECT 'kostya' NOT LIKE 'vedernikoff';
----
?column?
t


query
SELECT 'kostya' NOT LIKE 'kostya';
----
?column?
f


query
SELECT 'Kostya' LIKE 'kostya';
----
?column?
f


query
SELECT 'KOSTYA' LIKE 'kostya';
----
?column?
f


query
SELECT 'kostya' LIKE 'KOSTYA';
----
?column?
f


query
SELECT 'Kostya' ILIKE 'kostya';
----
?column?
t


query
SELECT 'KOSTYA' ILIKE 'kostya';
----
?column?
t


query
SELECT 'kostya' ILIKE 'KOSTYA';
----
?column?
t


query
SELECT 'KOSTYA' ILIKE 'k%';
----
?column?
t


query
SELECT 'Kostya' ILIKE '%TYA';
----
?column?
t


query
SELECT 'KoStYa' ILIKE 'kostya';
----
?column?
t


query
SELECT 'Kostya' NOT ILIKE 'kostya';
----
?column?
f


query
SELECT 'Kostya' NOT ILIKE 'vedernikoff';
----
?column?
t


query
SELECT 'KOSTYA' NOT ILIKE 'VEDERNIKOFF';
----
?column?
t


query
SELECT 5 BETWEEN 1 AND 10;
----
?column?
t


query
SELECT 5 BETWEEN 5 AND 10;
----
?column?
t


query
SELECT 5 BETWEEN 1 AND 5;
----
?column?
t


query
SELECT 5 BETWEEN 6 AND 10;
----
?column?
f


query
SELECT 5 NOT BETWEEN 1 AND 10;
----
?column?
f


query
SELECT 5 NOT BETWEEN 6 AND 10;
----
?column?
t


query
SELECT 'b' BETWEEN 'a' AND 'c';
----
?column?
t


query
SELECT 'z' BETWEEN 'a' AND 'c';
----
?column?
f


query
SELECT 5.5 BETWEEN 5.0 AND 6.0;
----
?column?
t


query
SELECT 4.9 BETWEEN 5.0 AND 6.0;
----
?column?
f


query
SELECT 5 BETWEEN SYMMETRIC 10 AND 1;
----
?column?
t


query
SELECT 5 BETWEEN SYMMETRIC 1 AND 10;
----
?column?
t


query
SELECT 15 BETWEEN SYMMETRIC 10 AND 1;
----
?column?
f


query
SELECT 5 NOT BETWEEN SYMMETRIC 10 AND 1;
----
?column?
f


query
SELECT 15 NOT BETWEEN SYMMETRIC 10 AND 1;
----
?column?
t


query
SELECT 1 IS DISTINCT FROM 1;
----
?column?
f


query
SELECT 1 IS DISTINCT FROM 2;
----
?column?
t


query
SELECT 1 IS NOT DISTINCT FROM 1;
----
?column?
t


query
SELECT 1 IS NOT DISTINCT FROM 2;
----
?column?
f


query
SELECT 'kostya' IS DISTINCT FROM 'kostya';
----
?column?
f


query
SELECT 'kostya' IS DISTINCT FROM 'vedernikoff';
----
?column?
t


query
SELECT 1 = ANY(ARRAY[1, 2, 3]);
----
?column?
t


query
SELECT 4 = ANY(ARRAY[1, 2, 3]);
----
?column?
f


query
SELECT 2 > ANY(ARRAY[1, 2, 3]);
----
?column?
t


query
SELECT 1 > ANY(ARRAY[1, 2, 3]);
----
?column?
f


query
SELECT 'kostya' = ANY(ARRAY['kostya', 'vedernikoff']);
----
?column?
t


query
SELECT 'ivan' = ANY(ARRAY['kostya', 'vedernikoff']);
----
?column?
f


query
SELECT 2 < ALL(ARRAY[3, 4, 5]);
----
?column?
t


query
SELECT 2 < ALL(ARRAY[1, 2, 3]);
----
?column?
f


query
SELECT 1 != ALL(ARRAY[2, 3, 4]);
----
?column?
t


query
SELECT 1 != ALL(ARRAY[1, 2, 3]);
----
?column?
f


query
SELECT 'kostya' != ALL(ARRAY['ivan', 'vedernikoff']);
----
?column?
t


query
SELECT 'kostya' != ALL(ARRAY['kostya', 'vedernikoff']);
----
?column?
f


query
SELECT 1 = ANY(ARRAY[]::integer[]);
----
?column?
f


query
SELECT 1 = ALL(ARRAY[]::integer[]);
----
?column?
t


query
SELECT 'kostya' ~~ 'kostya';
----
?column?
t


query
SELECT 'kostya' ~~ 'k%';
----
?column?
t


query
SELECT 'kostya' ~~ '%tya';
----
?column?
t


query
SELECT 'kostya' ~~ '%ost%';
----
?column?
t


query
SELECT 'kostya' ~~ 'k_stya';
----
?column?
t


query
SELECT 'kostya' ~~ 'vedernikoff';
----
?column?
f


query
SELECT 'kostya' !~~ 'vedernikoff';
----
?column?
t


query
SELECT 'kostya' !~~ 'kostya';
----
?column?
f


query
SELECT 'Kostya' ~~ 'kostya';
----
?column?
f


query
SELECT 'KOSTYA' ~~ 'kostya';
----
?column?
f


query
SELECT 'Kostya' ~~* 'kostya';
----
?column?
t


query
SELECT 'KOSTYA' ~~* 'kostya';
----
?column?
t


query
SELECT 'kostya' ~~* 'KOSTYA';
----
?column?
t


query
SELECT 'KOSTYA' ~~* 'k%';
----
?column?
t


query
SELECT 'Kostya' ~~* '%TYA';
----
?column?
t


query
SELECT 'KoStYa' ~~* 'kostya';
----
?column?
t


query
SELECT 'Kostya' !~~* 'kostya';
----
?column?
f


query
SELECT 'Kostya' !~~* 'vedernikoff';
----
?column?
t


query
SELECT 'KOSTYA' !~~* 'VEDERNIKOFF';
----
?column?
t


query
SELECT 'KoStYa' ~~* ALL(ARRAY['kostya', 'Kostya', 'kosty_']);
----
?column?
t


query
SELECT substring('lmaovedernikoff' FROM 5 FOR 10);
----
substring
vedernikof


query
SELECT (ARRAY[ARRAY[1, 2, 3], ARRAY[4, 5, 6]])[2][3];
----
array
6


query
SELECT * FROM (VALUES ('TUM', 'Munich'), ('LMU', 'Munich'), ('CMU', 'Pittsburgh'));
----
column1	column2
TUM	Munich
LMU	Munich
CMU	Pittsburgh


query
SELECT chr(65);
----
chr
A


query
SELECT concat('Hello', ' ', 'World');
----
concat
Hello World


query
SELECT length('SereneDB');
----
length
8


query
SELECT lower('SERENEDB');
----
lower
serenedb


query
SELECT upper('serenedb');
----
upper
SERENEDB


query
SELECT ltrim('   hello   ');
----
ltrim
hello


query
SELECT rtrim('   hello   ');
----
rtrim
   hello


query
SELECT trim('   hello   ');
----
btrim
hello


query
SELECT lpad('hi', 5, 'xy');
----
lpad
xyxhi


query
SELECT rpad('hi', 5, 'xy');
----
rpad
hixyx


query
SELECT replace('hello world', 'world', 'universe');
----
replace
hello universe


query
SELECT reverse('hello');
----
reverse
olleh


query
SELECT substr('SereneDB', 1, 6);
----
substr
Serene


query
SELECT strpos('hello world', 'world');
----
strpos
7


query
SELECT split_part('a,b,c', ',', 2);
----
split_part
b


query
SELECT abs(-42);
----
abs
42


query
SELECT acos(0.5);
----
acos
1.0471975511965979


query
SELECT asin(0.5);
----
asin
0.5235987755982989


query
SELECT atan(1.0);
----
atan
0.7853981633974483


query
SELECT atan2(1.0, 1.0);
----
atan2
0.7853981633974483


query
SELECT cbrt(8.0);
----
cbrt
2


query
SELECT ceil(3.14);
----
ceil
4


query
SELECT ceiling(3.14);
----
ceiling
4


query
SELECT cos(0.0);
----
cos
1


query
SELECT degrees(3.141592653589793);
----
degrees
180


query
SELECT round(exp(1.0), 5);
----
round
2.71828


query
SELECT floor(3.14);
----
floor
3


query
SELECT round(ln(2.718281828459045));
----
round
1


query
SELECT mod(10, 3);
----
mod
1


query
SELECT pi();
----
pi
3.141592653589793


query
SELECT pow(2.0, 3.0)::integer;
----
pow
8


query
SELECT power(2.0, 3.0)::integer;
----
power
8


query
SELECT radians(180.0);
----
radians
3.141592653589793


query
SELECT round(3.14159, 2);
----
round
3.14


query
SELECT sign(-42);
----
sign
-1


query
SELECT sin(0.0);
----
sin
0


query
SELECT sqrt(16.0)::integer;
----
sqrt
4


query
SELECT tan(0.0);
----
tan
0


query
SELECT trunc(3.14159);
----
trunc
3


query
SELECT width_bucket(5.0, 0.0, 10.0, 5);
----
width_bucket
3


query
SELECT regexp_replace('hello world', 'world', 'universe');
----
regexp_replace
hello universe


query
SELECT * FROM (VALUES ('TUM', 'Munich'::varchar), ('LMU', 'Munich'), ('CMU'::varchar, 'Pittsburgh'));
----
column1	column2
TUM	Munich
LMU	Munich
CMU	Pittsburgh


query
SELECT '123' + 123;
----
?column?
246


# TODO better error message
query error
SELECT '123' + '123';


query
select -('-1'::integer);
----
?column?
1


query
select +('-1'::integer);
----
?column?
-1


query
select ~('-1'::integer);
----
?column?
0


# TODO(mkornaukhov) remove these tests as soon as we enable sqllogic tests

onlyif serenedb
statement ok
CREATE TABLE t1(a INTEGER, b INTEGER, c INTEGER, d INTEGER, e INTEGER)


onlyif serenedb
query
EXPLAIN (ALL_PLANS)
SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
        WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
       CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
        WHEN a<b+3 THEN 333 ELSE 444 END,
       a+b*2+c*3+d*4,
       a+b*2+c*3,
       c,
       CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
       abs(b-c)
  FROM t1
 WHERE EXISTS(SELECT 1 FROM t1 AS x WHERE x.b<t1.b)
    OR b>c
    OR d NOT BETWEEN 110 AND 150
 ORDER BY 4,1,5,2,6,3,7
----
QUERY PLAN
LOGICAL PLAN:
- Project: -> ROW<"case":INTEGER,"case":INTEGER,"?column?":INTEGER,"?column?":INTEGER,"c":INTEGER,"case":INTEGER,"abs":INTEGER>
    case := SWITCH(presto_eq(presto_plus(a, 1), b), 111, presto_eq(presto_plus(a, 1), c), 222, presto_eq(presto_plus(a, 1), d), 333, presto_eq(presto_plus(a, 1), e), 444, 555)
    case := SWITCH(presto_lt(a, presto_minus(b, 3)), 111, presto_lte(a, b), 222, presto_lt(a, presto_plus(b, 3)), 333, 444)
    ?column? := presto_plus(presto_plus(presto_plus(a, presto_multiply(b, 2)), presto_multiply(c, 3)), presto_multiply(d, 4))
    ?column? := presto_plus(presto_plus(a, presto_multiply(b, 2)), presto_multiply(c, 3))
    c := c
    case := SWITCH(presto_gt(CAST(c AS DOUBLE), subquery(- Aggregate() -> ROW<"avg":DOUBLE>     avg := presto_avg(c)   - TableScan: t1 -> ROW<"a":INTEGER,"b":INTEGER,"c":INTEGER,"d":INTEGER,"e":INTEGER> )), presto_multiply(a, 2), presto_multiply(b, 10))
    abs := presto_abs(presto_minus(b, c))
  - Sort: presto_plus(presto_plus(a, presto_multiply(b, 2)), presto_multiply(c, 3)) ASC NULLS LAST, SWITCH(presto_eq(presto_plus(a, 1), b), 111, presto_eq(presto_plus(a, 1), c), 222, presto_eq(presto_plus(a, 1), d), 333, presto_eq(presto_plus(a, 1), e), 444, 555) ASC NULLS LAST, c ASC NULLS LAST, SWITCH(presto_lt(a, presto_minus(b, 3)), 111, presto_lte(a, b), 222, presto_lt(a, presto_plus(b, 3)), 333, 444) ASC NULLS LAST, SWITCH(presto_gt(CAST(c AS DOUBLE), subquery(- Aggregate() -> ROW<"avg":DOUBLE>     avg := presto_avg(c)   - TableScan: t1 -> ROW<"a":INTEGER,"b":INTEGER,"c":INTEGER,"d":INTEGER,"e":INTEGER> )), presto_multiply(a, 2), presto_multiply(b, 10)) ASC NULLS LAST, presto_plus(presto_plus(presto_plus(a, presto_multiply(b, 2)), presto_multiply(c, 3)), presto_multiply(d, 4)) ASC NULLS LAST, presto_abs(presto_minus(b, c)) ASC NULLS LAST -> ROW<"a":INTEGER,"b":INTEGER,"c":INTEGER,"d":INTEGER,"e":INTEGER>
    - Filter: OR(EXISTS(subquery(- Project: -> ROW<"?column?":INTEGER>     ?column? := 1   - Filter: presto_lt(b, b) -> ROW<"a":INTEGER,"b":INTEGER,"c":INTEGER,"d":INTEGER,"e":INTEGER>     - TableScan: t1 -> ROW<"a":INTEGER,"b":INTEGER,"c":INTEGER,"d":INTEGER,"e":INTEGER> )), presto_gt(b, c), presto_not(presto_between(d, 110, 150))) -> ROW<"a":INTEGER,"b":INTEGER,"c":INTEGER,"d":INTEGER,"e":INTEGER>
      - TableScan: t1 -> ROW<"a":INTEGER,"b":INTEGER,"c":INTEGER,"d":INTEGER,"e":INTEGER>
INITIAL QUERY GRAPH:
dt1: case, case, ?column?, ?column?, c, case, abs
  output:
    case := __switch(presto_eq(t2.b, presto_plus(t2.a, 1)), 111, presto_eq(t2.c, presto_plus(t2.a, 1)), 222, presto_eq(t2.d, presto_plus(t2.a, 1)), 333, presto_eq(t2.e, presto_plus(t2.a, 1)), 444, 555)
    case := __switch(presto_lt(t2.a, presto_minus(t2.b, 3)), 111, presto_lte(t2.a, t2.b), 222, presto_lt(t2.a, presto_plus(t2.b, 3)), 333, 444)
    ?column? := presto_plus(presto_plus(presto_plus(t2.a, presto_multiply(t2.b, 2)), presto_multiply(t2.c, 3)), presto_multiply(t2.d, 4))
    ?column? := presto_plus(presto_plus(t2.a, presto_multiply(t2.b, 2)), presto_multiply(t2.c, 3))
    c := t2.c
    case := __switch(presto_lt(dt5.avg, __cast(t2.c)), presto_multiply(t2.a, 2), presto_multiply(t2.b, 10))
    abs := presto_abs(presto_minus(t2.b, t2.c))
  tables: t2, dt3, dt5
  joins:
    t2 SEMI dt3 ON  FILTER presto_gt(t2.b, dt3.b)
  syntactic join order: 7, 13, 28
  filter: __or(dt1.__mark0, presto_gt(t2.b, t2.c), presto_not(presto_between(t2.d, 110, 150)))
  orderBy: presto_plus(presto_plus(t2.a, presto_multiply(t2.b, 2)), presto_multiply(t2.c, 3)) ASC NULLS LAST, __switch(presto_eq(t2.b, presto_plus(t2.a, 1)), 111, presto_eq(t2.c, presto_plus(t2.a, 1)), 222, presto_eq(t2.d, presto_plus(t2.a, 1)), 333, presto_eq(t2.e, presto_plus(t2.a, 1)), 444, 555) ASC NULLS LAST, t2.c ASC NULLS LAST, __switch(presto_lt(t2.a, presto_minus(t2.b, 3)), 111, presto_lte(t2.a, t2.b), 222, presto_lt(t2.a, presto_plus(t2.b, 3)), 333, 444) ASC NULLS LAST, __switch(presto_lt(dt5.avg, __cast(t2.c)), presto_multiply(t2.a, 2), presto_multiply(t2.b, 10)) ASC NULLS LAST, presto_plus(presto_plus(presto_plus(t2.a, presto_multiply(t2.b, 2)), presto_multiply(t2.c, 3)), presto_multiply(t2.d, 4)) ASC NULLS LAST, presto_abs(presto_minus(t2.b, t2.c)) ASC NULLS LAST
t2: a, b, c, d, e
  table: t1
dt3: b, ?column?
  output:
    b := t4.b
    ?column? := 1
  tables: t4
t4: b
  table: t1
dt5: avg
  output:
    avg := dt5.avg
  tables: t6
  aggregates: presto_avg(t6.c) AS avg
t6: c
  table: t1
FINAL QUERY GRAPH:
dt1: case, case, ?column?, ?column?, c, case, abs
  output:
    case := __switch(presto_eq(t2.b, presto_plus(t2.a, 1)), 111, presto_eq(t2.c, presto_plus(t2.a, 1)), 222, presto_eq(t2.d, presto_plus(t2.a, 1)), 333, presto_eq(t2.e, presto_plus(t2.a, 1)), 444, 555)
    case := __switch(presto_lt(t2.a, presto_minus(t2.b, 3)), 111, presto_lte(t2.a, t2.b), 222, presto_lt(t2.a, presto_plus(t2.b, 3)), 333, 444)
    ?column? := presto_plus(presto_plus(presto_plus(t2.a, presto_multiply(t2.b, 2)), presto_multiply(t2.c, 3)), presto_multiply(t2.d, 4))
    ?column? := presto_plus(presto_plus(t2.a, presto_multiply(t2.b, 2)), presto_multiply(t2.c, 3))
    c := t2.c
    case := __switch(presto_lt(dt5.avg, __cast(t2.c)), presto_multiply(t2.a, 2), presto_multiply(t2.b, 10))
    abs := presto_abs(presto_minus(t2.b, t2.c))
  tables: t2, dt3, dt5
  joins:
    t2 SEMI dt3 ON  FILTER presto_gt(t2.b, dt3.b)
  syntactic join order: 7, 13, 28
  filter: __or(dt1.__mark0, presto_gt(t2.b, t2.c), presto_not(presto_between(t2.d, 110, 150)))
  orderBy: presto_plus(presto_plus(t2.a, presto_multiply(t2.b, 2)), presto_multiply(t2.c, 3)) ASC NULLS LAST, __switch(presto_eq(t2.b, presto_plus(t2.a, 1)), 111, presto_eq(t2.c, presto_plus(t2.a, 1)), 222, presto_eq(t2.d, presto_plus(t2.a, 1)), 333, presto_eq(t2.e, presto_plus(t2.a, 1)), 444, 555) ASC NULLS LAST, t2.c ASC NULLS LAST, __switch(presto_lt(t2.a, presto_minus(t2.b, 3)), 111, presto_lte(t2.a, t2.b), 222, presto_lt(t2.a, presto_plus(t2.b, 3)), 333, 444) ASC NULLS LAST, __switch(presto_lt(dt5.avg, __cast(t2.c)), presto_multiply(t2.a, 2), presto_multiply(t2.b, 10)) ASC NULLS LAST, presto_plus(presto_plus(presto_plus(t2.a, presto_multiply(t2.b, 2)), presto_multiply(t2.c, 3)), presto_multiply(t2.d, 4)) ASC NULLS LAST, presto_abs(presto_minus(t2.b, t2.c)) ASC NULLS LAST
t2: a, b, c, d, e
  table: t1
dt3: b, ?column?
  output:
    b := t4.b
    ?column? := 1
  tables: t4
t4: b
  table: t1
dt5: avg
  output:
    avg := dt5.avg
  tables: t6
  aggregates: presto_avg(t6.c) AS avg
t6: c
  table: t1
PHYSICAL PLAN:
Project -> dt1.case, dt1.case, dt1.?column?, dt1.?column?, dt1.c, dt1.case, dt1.abs
    dt1.case := dt1.__p51
    dt1.case := dt1.__p57
    dt1.?column? := dt1.__p66
    dt1.?column? := dt1.__p40
    dt1.c := t2.c
    dt1.case := dt1.__p63
    dt1.abs := dt1.__p68
  OrderBy -> dt1.__p40, dt1.__p51, t2.c, dt1.__p57, dt1.__p63, dt1.__p66, dt1.__p68
    Project -> dt1.__p40, dt1.__p51, t2.c, dt1.__p57, dt1.__p63, dt1.__p66, dt1.__p68
        dt1.__p40 := presto_plus(presto_plus(t2.a, presto_multiply(t2.b, 2)), presto_multiply(t2.c, 3))
        dt1.__p51 := __switch(presto_eq(t2.b, presto_plus(t2.a, 1)), 111, presto_eq(t2.c, presto_plus(t2.a, 1)), 222, presto_eq(t2.d, presto_plus(t2.a, 1)), 333, presto_eq(t2.e, presto_plus(t2.a, 1)), 444, 555)
        t2.c := t2.c
        dt1.__p57 := __switch(presto_lt(t2.a, presto_minus(t2.b, 3)), 111, presto_lte(t2.a, t2.b), 222, presto_lt(t2.a, presto_plus(t2.b, 3)), 333, 444)
        dt1.__p63 := __switch(presto_lt(dt5.avg, __cast(t2.c)), presto_multiply(t2.a, 2), presto_multiply(t2.b, 10))
        dt1.__p66 := presto_plus(presto_plus(presto_plus(t2.a, presto_multiply(t2.b, 2)), presto_multiply(t2.c, 3)), presto_multiply(t2.d, 4))
        dt1.__p68 := presto_abs(presto_minus(t2.b, t2.c))
      Join INNER Cross -> t2.a, t2.b, t2.c, t2.d, t2.e, dt5.avg
        Filter -> t2.a, t2.b, t2.c, t2.d, t2.e, dt1.__mark0
            __or(dt1.__mark0, presto_gt(t2.b, t2.c), presto_not(presto_between(t2.d, 110, 150)))
          Join LEFT SEMI (PROJECT) Cross -> t2.a, t2.b, t2.c, t2.d, t2.e, dt1.__mark0
              presto_gt(t2.b, dt3.b)
            TableScan -> t2.a, t2.b, t2.c, t2.d, t2.e
              table: t1
            Project (redundant) -> dt3.b
                dt3.b := t4.b
              TableScan -> t4.b
                table: t1
        Project (redundant) -> dt5.avg
            dt5.avg := dt5.avg
          Aggregation -> dt5.avg
              dt5.avg := presto_avg(t6.c)
            TableScan -> t6.c
              table: t1
EXECUTION PLAN:
Fragment 0:  numWorkers=0:
-- Project[9][expressions: (case:INTEGER, "dt1.__p51"), (case:INTEGER, "dt1.__p57"), (?column?:INTEGER, "dt1.__p66"), (?column?:INTEGER, "dt1.__p40"), (c:INTEGER, "c"), (case:INTEGER, "dt1.__p63"), (abs:INTEGER, "dt1.__p68")] -> "case":INTEGER, "case":INTEGER, "?column?":INTEGER, "?column?":INTEGER, "c":INTEGER, "case":INTEGER, "abs":INTEGER
  -- OrderBy[8][dt1.__p40 ASC NULLS LAST, dt1.__p51 ASC NULLS LAST, c ASC NULLS LAST, dt1.__p57 ASC NULLS LAST, dt1.__p63 ASC NULLS LAST, dt1.__p66 ASC NULLS LAST, dt1.__p68 ASC NULLS LAST] -> "dt1.__p40":INTEGER, "dt1.__p51":INTEGER, "c":INTEGER, "dt1.__p57":INTEGER, "dt1.__p63":INTEGER, "dt1.__p66":INTEGER, "dt1.__p68":INTEGER
    -- Project[7][expressions: (dt1.__p40:INTEGER, presto_plus(presto_plus("a",presto_multiply("b",2)),presto_multiply("c",3))), (dt1.__p51:INTEGER, switch(presto_eq("b",presto_plus("a",1)),111,presto_eq("c",presto_plus("a",1)),222,presto_eq("d",presto_plus("a",1)),333,presto_eq("e",presto_plus("a",1)),444,555)), (c:INTEGER, "c"), (dt1.__p57:INTEGER, switch(presto_lt("a",presto_minus("b",3)),111,presto_lte("a","b"),222,presto_lt("a",presto_plus("b",3)),333,444)), (dt1.__p63:INTEGER, switch(presto_lt("avg",cast("c" as DOUBLE)),presto_multiply("a",2),presto_multiply("b",10))), (dt1.__p66:INTEGER, presto_plus(presto_plus(presto_plus("a",presto_multiply("b",2)),presto_multiply("c",3)),presto_multiply("d",4))), (dt1.__p68:INTEGER, presto_abs(presto_minus("b","c")))] -> "dt1.__p40":INTEGER, "dt1.__p51":INTEGER, "c":INTEGER, "dt1.__p57":INTEGER, "dt1.__p63":INTEGER, "dt1.__p66":INTEGER, "dt1.__p68":INTEGER
      -- NestedLoopJoin[6][INNER] -> "a":INTEGER, "b":INTEGER, "c":INTEGER, "d":INTEGER, "e":INTEGER, "avg":DOUBLE
        -- Filter[0][expression: or("dt1.__mark0",presto_gt("b","c"),presto_not(presto_between("d",110,150)))] -> "a":INTEGER, "b":INTEGER, "c":INTEGER, "d":INTEGER, "e":INTEGER, "dt1.__mark0":BOOLEAN
          -- NestedLoopJoin[3][LEFT SEMI (PROJECT), joinCondition: presto_gt("b","b")] -> "a":INTEGER, "b":INTEGER, "c":INTEGER, "d":INTEGER, "e":INTEGER, "dt1.__mark0":BOOLEAN
            -- TableScan[1][t1] -> "a":INTEGER, "b":INTEGER, "c":INTEGER, "d":INTEGER, "e":INTEGER
            -- TableScan[2][t1] -> "b":INTEGER
        -- Aggregation[5][SINGLE avg := presto_avg("c")] -> "avg":DOUBLE
          -- TableScan[4][t1] -> "c":INTEGER
