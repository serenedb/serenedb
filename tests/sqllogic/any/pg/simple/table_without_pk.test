statement ok
CREATE TABLE no_pk (a INTEGER, b INTEGER, c VARCHAR);

query
SELECT * FROM no_pk ORDER BY a;
----
a	b	c


statement count 1
INSERT INTO no_pk VALUES (42, 100500, 'aboba');


statement count 1
INSERT INTO no_pk VALUES (123, 456, NULL);


query
SELECT * FROM no_pk ORDER BY a;
----
a	b	c
42	100500	aboba
123	456	NULL


query ?
SELECT a + b FROM no_pk;
----
?column?
100542
579


statement count 1
DELETE FROM no_pk WHERE a = 123;


query
SELECT * FROM no_pk ORDER BY a;
----
a	b	c
42	100500	aboba


statement count 1
UPDATE no_pk SET b = 300 WHERE a = 42;


query
SELECT * FROM no_pk ORDER BY a;
----
a	b	c
42	300	aboba


statement count 1
INSERT INTO no_pk VALUES (123, 888, 'new str');

statement count 3
INSERT INTO no_pk VALUES (111, 222, 'same'), (111, 222, 'same'), (111, 222, 'same');

query
SELECT * FROM no_pk ORDER BY a;
----
a	b	c
42	300	aboba
111	222	same
111	222	same
111	222	same
123	888	new str


query
SELECT 1 FROM no_pk;
----
?column?
1
1
1
1
1


query
SELECT count(*) FROM no_pk;
----
count
5


# Column name as for generated column
statement ok
CREATE TABLE collision (a INTEGER, sdb_generated_pk VARCHAR);


query
SELECT * FROM collision ORDER BY a;
----
a	sdb_generated_pk


statement ok
INSERT INTO collision VALUES (42, 'aboba');


query
SELECT * FROM collision ORDER BY a;
----
a	sdb_generated_pk
42	aboba


statement ok
UPDATE collision SET sdb_generated_pk = 'lol' WHERE sdb_generated_pk = 'aboba';


statement ok
DELETE FROM collision WHERE sdb_generated_pk = 'aboba';


query
SELECT * FROM collision ORDER BY a;
----
a	sdb_generated_pk
42	lol


statement ok
DELETE FROM collision WHERE sdb_generated_pk = 'lol';


query
SELECT * FROM collision ORDER BY a;
----
a	sdb_generated_pk


# Table without columns
statement ok
CREATE TABLE no_columns ();


# TODO(mkornaukhov) fix sqllogictest-rs to process this case properly
#query
#SELECT * FROM no_columns;
#----


query
SELECT count(*) FROM no_columns;
----
count
0


query error
SELECT field FROM no_columns;
----
db error: ERROR: column "field" does not exist
