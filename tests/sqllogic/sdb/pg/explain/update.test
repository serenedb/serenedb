statement ok
CREATE TABLE t (column1 VARCHAR PRIMARY KEY, column2 INT);

query
explain (logical, execution) select * from t;
----
QUERY PLAN
LOGICAL PLAN:
- TableScan: t -> ROW<"column1":VARCHAR,"column2":INTEGER>
EXECUTION PLAN:
Fragment 0:  numWorkers=0:
-- TableScan[0][t] -> "column1":VARCHAR, "column2":INTEGER

query
explain (logical, execution) update t set column2 = 42 where column1 = 'foo';
----
QUERY PLAN
LOGICAL PLAN:
- TableWrite UPDATE: -> ROW<rows:BIGINT>
    column1 := column1
    column2 := 42
  - Filter: presto_eq(column1, foo) -> ROW<"column1":VARCHAR,"column2":INTEGER>
    - TableScan: t -> ROW<"column1":VARCHAR,"column2":INTEGER>
EXECUTION PLAN:
Fragment 0:  numWorkers=0:
-- TableWrite[3][serenedb(table=t, kind=UPDATE)] -> rows:BIGINT
  -- Project[2][expressions: (column1:VARCHAR, "column1"), (dt1.__p9:INTEGER, 42)] -> "column1":VARCHAR, "dt1.__p9":INTEGER
    -- Filter[1][expression: presto_eq("column1",foo)] -> "column1":VARCHAR
      -- TableScan[0][t] -> "column1":VARCHAR


query
explain (logical, execution) update t set column2 = column2 + 1;
----
QUERY PLAN
LOGICAL PLAN:
- TableWrite UPDATE: -> ROW<rows:BIGINT>
    column1 := column1
    column2 := presto_plus(column2, 1)
  - TableScan: t -> ROW<"column1":VARCHAR,"column2":INTEGER>
EXECUTION PLAN:
Fragment 0:  numWorkers=0:
-- TableWrite[2][serenedb(table=t, kind=UPDATE)] -> rows:BIGINT
  -- Project[1][expressions: (column1:VARCHAR, "column1"), (dt1.__p10:INTEGER, presto_plus("column2",1))] -> "column1":VARCHAR, "dt1.__p10":INTEGER
    -- TableScan[0][t] -> "column1":VARCHAR, "column2":INTEGER
